package manager;

import java.io.FileNotFoundException;
import java.io.IOException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.StringTokenizer;

import model.CommitCodeList;
import model.CommitInfo;
import model.OriginFile;
import model.OriginFolder;
import model.OriginProject;
import socialProExceptions.CommitExcetion;
import socialProExceptions.DAOException;
import socialProExceptions.FileException;
import socialProExceptions.FolderException;
import socialProExceptions.MemberException;
import socialProExceptions.ProjectException;
import socialProExceptions.RemoteFileException;
import socialProExceptions.TeamException;
import sun.util.locale.StringTokenIterator;

import com.jcraft.jsch.JSchException;
import com.jcraft.jsch.SftpException;

import form.CommitForm;

//
//
//  Generated by StarUML(tm) Java Add-In
//
//  @ Project : Untitled
//  @ File Name : CommitInfoManager.java
//  @ Date : 2015-07-28
//  @ Author : 
//
//




public class CommitInfoManager {
	
	private static CommitInfoManager INSTANCE;
	private Map<String,CommitInfo> commitMap;
	private Map<String,Map<String,CommitCodeList>> memberCommitMap;
	private Map<String,Map<String,Map<String,CommitCodeList>>> teamCommitMap;
	static{INSTANCE = new CommitInfoManager();}
	private CommitInfoManager(){
		this.commitMap = new HashMap<String, CommitInfo>();
		this.memberCommitMap = new HashMap<String, Map<String,CommitCodeList>>();
		this.teamCommitMap = new HashMap<String, Map<String,Map<String,CommitCodeList>>>();
	}
	
	public static CommitInfoManager getINSTANCE() {
		return INSTANCE;
	}

///////////////////                 insert                        /////////////////////////////
	
	
	public boolean createCommitInfo(String objectKind, String objectCode, String title,String content, String makeDate, String member) throws DAOException, CommitExcetion, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, ProjectException, MemberException, FileException, RemoteFileException, TeamException {
	
		CommitInfo commitInfo = new CommitInfo(objectCode, objectKind, content, makeDate, member, false, content, title);
		String commitCode = CommitInfoDBManager.getINSTANCE().insertCommitInfo(commitInfo);
		if(commitCode!=null){
			commitInfo.setCode(commitCode);
			this.insertModel(commitInfo);
			return true;
		}
		return false;
	}
	public boolean putOnlyCommitInfo(String memberCode, String projectCode ,CommitInfo commitInfo) throws DAOException, CommitExcetion, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, ProjectException, MemberException, FileException, RemoteFileException, TeamException {
		
		//already insert information into db
		//just insert in server
		//init memberCommitMap
		if(!this.memberCommitMap.containsKey(memberCode))this.loadMemberProjectCommit(memberCode, projectCode);
		
		//insert into memberCommitMap(member)  commitCode
		if(this.memberCommitMap.containsKey(memberCode)){
			if(this.memberCommitMap.get(memberCode).containsKey(projectCode)){
				
				if(commitInfo.isMerge()){
					this.memberCommitMap.get(memberCode).get(projectCode).addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}else{
					this.memberCommitMap.get(memberCode).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}

			}else{
				CommitCodeList codeList = new CommitCodeList();

				if(commitInfo.isMerge()){
					codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}else{
					codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}
				codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
				this.memberCommitMap.get(memberCode).put(projectCode, codeList);
			}
		}else{
			CommitCodeList codeList = new CommitCodeList();

			if(commitInfo.isMerge()){
				codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
			}else{
				codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
			}
			codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
			Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
			val.put(projectCode, codeList);
			this.memberCommitMap.put(memberCode, val);
		}
		
		//insert just information
		this.commitMap.put(commitInfo.getCode(), commitInfo);
		
		//test data
		System.out.println("CommitInfoManager   putCommitInfo()  end ");
		System.out.println("\n Test....  start ");
		Map<String, List<String>> ncodeMap = this.memberCommitMap.get(memberCode).get(projectCode).getNotMergeCodeMap();
		if(!ncodeMap.isEmpty()){
			for(String objCode : ncodeMap.keySet()){
				System.out.println("objCode   Start: "+objCode);
				List<String> nCodeList = ncodeMap.get(objCode);
				if(!nCodeList.isEmpty()){
				for(String nCode : nCodeList){
					CommitInfo commitInfot = this.commitMap.get(nCode);
					System.out.println(" commitTitle : "+commitInfot.getTitle()+" commitCode : "+commitInfot.getCode());
				}
				}
			}
		}
		
		System.out.println(" Test....  END \n");
		return true;
	}
	public boolean putCommitInfo(String memberCode, String projectCode ,CommitInfo commitInfo) throws DAOException, CommitExcetion, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, ProjectException, MemberException, FileException, RemoteFileException, TeamException {
	
		//insert in db
		String commitCode = CommitInfoDBManager.getINSTANCE().insertCommitInfo(commitInfo);
		
		//init memberCommitMap
		if(!this.memberCommitMap.containsKey(memberCode))this.loadMemberProjectCommit(memberCode, projectCode);
		
		//insert into memberCommitMap(member)  commitCode
		if(commitCode!=null){
			commitInfo.setCode(commitCode);
			if(this.memberCommitMap.containsKey(memberCode)){
				if(this.memberCommitMap.get(memberCode).containsKey(projectCode)){
					
					if(commitInfo.isMerge()){
						this.memberCommitMap.get(memberCode).get(projectCode).addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}else{
						this.memberCommitMap.get(memberCode).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}

				}else{
					CommitCodeList codeList = new CommitCodeList();

					if(commitInfo.isMerge()){
						codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}else{
						codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}
					codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
					this.memberCommitMap.get(memberCode).put(projectCode, codeList);
				}
			}else{
				CommitCodeList codeList = new CommitCodeList();

				if(commitInfo.isMerge()){
					codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}else{
					codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}
				codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
				Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
				val.put(projectCode, codeList);
				this.memberCommitMap.put(memberCode, val);
			}
			this.commitMap.put(commitCode, commitInfo);
		}

		//insert just information
		CommitCodeList codeList = this.memberCommitMap.get(memberCode).get(projectCode);
		
		
		//test data
		System.out.println("CommitInfoManager   putCommitInfo()  end ");
		System.out.println("\n Test....  start ");
		Map<String, List<String>> ncodeMap = this.memberCommitMap.get(memberCode).get(projectCode).getNotMergeCodeMap();
		if(!ncodeMap.isEmpty()){
			for(String nCode : ncodeMap.keySet()){
				System.out.println("objCode   Start: "+nCode);
				List<String> nCodeList = ncodeMap.get(nCode);
				if(!nCodeList.isEmpty()){
				for(String cocod : nCodeList){
					CommitInfo commitInfot = this.commitMap.get(cocod);
					System.out.println(" commitTitle : "+commitInfot.getTitle()+" commitCode : "+commitInfot.getCode());
				}	
				}
				System.out.println("objCode   End: "+nCode);
			}
		}
		System.out.println(" Test....  END \n");
		return true;
	}
	public boolean putOnlyTeamCommitInfo(String teamCode,String memberCode, String projectCode ,CommitInfo commitInfo) throws DAOException, CommitExcetion, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, ProjectException, MemberException, FileException, RemoteFileException, TeamException {
			
		//already insert information into db
		//just insert in server
		//init memberCommitMap
		if(!this.teamCommitMap.containsKey(teamCode))this.loadTeamProjectCommit(teamCode, memberCode, projectCode);
		
		//insert into memberCommitMap(member)  commitCode
		if(this.teamCommitMap.containsKey(teamCode)){
			if(this.teamCommitMap.get(teamCode).containsKey(memberCode)){
				if(this.teamCommitMap.get(teamCode).get(memberCode).containsKey(projectCode)){
					
					if(commitInfo.isMerge()){
						this.teamCommitMap.get(teamCode).get(memberCode).get(projectCode).addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}else{
						this.teamCommitMap.get(teamCode).get(memberCode).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}
	
				}else{
					CommitCodeList codeList = new CommitCodeList();
	
					if(commitInfo.isMerge()){
						codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}else{
						codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}
					codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
					this.teamCommitMap.get(teamCode).get(memberCode).put(projectCode, codeList);
				}
			}else{
				CommitCodeList codeList = new CommitCodeList();
	
				if(commitInfo.isMerge()){
					codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}else{
					codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}
				codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
				Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
				val.put(projectCode, codeList);
				this.teamCommitMap.get(teamCode).put(memberCode, val);
			}
		}else{
			CommitCodeList codeList = new CommitCodeList();
	
			if(commitInfo.isMerge()){
				codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
			}else{
				codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
			}
			codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
			Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
			val.put(projectCode, codeList);
			Map<String,Map<String,CommitCodeList>> val2 = new HashMap<String, Map<String,CommitCodeList>>();
			val2.put(memberCode, val);
			this.teamCommitMap.put(teamCode, val2);
		}
		
		//insert just information
		this.commitMap.put(commitInfo.getCode(), commitInfo);

		return true;
	}
	public boolean putTeamCommitInfo(String teamCode,String memberCode, String projectCode ,CommitInfo commitInfo) throws DAOException, CommitExcetion, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, ProjectException, MemberException, FileException, RemoteFileException, TeamException {
		
		//init memberCommitMap
		if(!this.teamCommitMap.containsKey(teamCode))this.loadTeamProjectCommit(teamCode, memberCode, projectCode);
				
		//insert into db
		String commitCode = CommitInfoDBManager.getINSTANCE().insertCommitInfo(commitInfo);
		
		//insert into memberCommitMap(member)  commitCode
		if(commitCode!=null){
			commitInfo.setCode(commitCode);
			if(this.teamCommitMap.containsKey(teamCode)){
				if(this.teamCommitMap.get(teamCode).containsKey(memberCode)){
					if(this.teamCommitMap.get(teamCode).get(memberCode).containsKey(projectCode)){
						
						if(commitInfo.isMerge()){
							this.teamCommitMap.get(teamCode).get(memberCode).get(projectCode).addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
						}else{
							this.teamCommitMap.get(teamCode).get(memberCode).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
						}

					}else{
						CommitCodeList codeList = new CommitCodeList();

						if(commitInfo.isMerge()){
							codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
						}else{
							codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
						}
						codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
						this.teamCommitMap.get(teamCode).get(memberCode).put(projectCode, codeList);
					}
				}else{
					CommitCodeList codeList = new CommitCodeList();

					if(commitInfo.isMerge()){
						codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}else{
						codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}
					codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
					Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
					val.put(projectCode, codeList);
					this.teamCommitMap.get(teamCode).put(memberCode, val);
				}
			}else{
				CommitCodeList codeList = new CommitCodeList();

				if(commitInfo.isMerge()){
					codeList.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}else{
					codeList.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				}
				codeList.getLatestCodePerFolder().put(commitInfo.getObjectCode(), commitInfo.getCode());
				Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
				val.put(projectCode, codeList);
				Map<String,Map<String,CommitCodeList>> val2 = new HashMap<String, Map<String,CommitCodeList>>();
				val2.put(memberCode, val);
				this.teamCommitMap.put(teamCode, val2);
			}
			//insert just information
			this.commitMap.put(commitCode, commitInfo);
		}

		return true;
	}

	public boolean createTeamCommitInfo(String teamCode,String objectKind, String objectCode, String title,String content, String makeDate, String member) throws DAOException, CommitExcetion, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, FileException, RemoteFileException, MemberException, ProjectException, TeamException {
	
		CommitInfo commitInfo = new CommitInfo(objectCode, objectKind, content, makeDate, member, false, content, title);
		String commitCode = CommitInfoDBManager.getINSTANCE().insertCommitInfo(commitInfo);
		if(commitCode!=null){
			commitInfo.setCode(commitCode);
			this.insertModel(teamCode,commitInfo);
			return true;
		}
		return false;
	}
	
/////////////////////////////  load   ///////////////////////////////
	
	public void loadMemberProjectCommit(String memberCode, String projectCode) throws DAOException, ParseException, FolderException, IOException, FileException, ProjectException, TeamException, SftpException, JSchException, RemoteFileException, MemberException{
		//if originproject
		List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchMemberProjectCommit(memberCode, projectCode);
		if(!commitInfoList.isEmpty()){
			this.insertModel(commitInfoList,memberCode);
		}
	}

	public void loadTeamProjectCommit(String teamCode,String memberCode, String projectCode) throws DAOException, ParseException, FolderException, IOException, FileException, ProjectException, TeamException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		//if originproject
		List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchTeamProjectCommit(memberCode, teamCode, projectCode);
		if(!commitInfoList.isEmpty()){
			this.insertModel(commitInfoList,teamCode,memberCode);
		}
	}
	
////////////////////                 search                   ////////////////////////////////////////
	

	public Map<String,List<String>> searchCommitCodeListForCodeMap(List<String> commitCodeList) throws FileNotFoundException, DAOException, FileException, SftpException, IOException, JSchException, RemoteFileException, ParseException, FolderException, MemberException, ProjectException, TeamException{
		
		
		Map<String,List<String>> resMap = new HashMap<String, List<String>>();
		if(commitCodeList.isEmpty())return resMap;
		
		
		for(String commitCode : commitCodeList){
			CommitInfo res = null;
			List<CommitInfo> commitInfoList = new ArrayList<CommitInfo>();
			String commitCode_ = new String();
			
			//find data from db for manager
			if(!this.commitMap.containsKey(commitCode)){
				commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
			}else{
				res = this.commitMap.get(commitCode);
				if(res.getOriginFileDescriptioin()==null){
					commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
					res=null;
				}
			}
			
			//make return type
			if(!commitInfoList.isEmpty()){
				System.out.println("commitInfoList is not empty....");
				for(CommitInfo commitInfo : commitInfoList){
					commitCode_ = commitInfo.getCode();
					if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
					this.commitMap.put(commitCode_, commitInfo);
					if(commitCode.equals(commitCode_)){
						String objCode = commitInfo.getObjectCode();
						if(resMap.containsKey(objCode))resMap.get(objCode).add(commitCode);
						else{
							List<String> val = new ArrayList<String>();
							val.add(commitCode);
							resMap.put(objCode, val);
						}
					}
				}
			}else if(res!=null){
				System.out.println("commitInfo is not empty....");
				String objCode = res.getObjectCode();
				if(resMap.containsKey(objCode))resMap.get(objCode).add(commitCode);
				else{
					List<String> val = new ArrayList<String>();
					val.add(commitCode);
					resMap.put(objCode, val);
				}
			} 
		}
		
		
		return resMap;
	}

	public Map<String,List<CommitInfo>> searchCommitCodeListForInfoMap(List<String> commitCodeList) throws FileNotFoundException, DAOException, FileException, SftpException, IOException, JSchException, RemoteFileException, ParseException, FolderException, MemberException, ProjectException, TeamException{
		
		System.out.println("\n           CommitInfoManager    searchCommitCodeListForInfoMap   line     434  "+commitCodeList.size());
		Map<String,List<CommitInfo>> resMap = new HashMap<String, List<CommitInfo>>();
		if(commitCodeList.isEmpty())return resMap;
		
		
		for(String commitCode : commitCodeList){
			System.out.println("commitCode L: "+commitCode);
			CommitInfo res = null;
			List<CommitInfo> commitInfoList = new ArrayList<CommitInfo>();
			String commitCode_ = new String();
			
			//find data from db for manager
			if(!this.commitMap.containsKey(commitCode)){
				commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
			}else{
				res = this.commitMap.get(commitCode);
				if(res.getOriginFileDescriptioin()==null){
					commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
					res=null;
				}
			}
			
			//make return type
			if(!commitInfoList.isEmpty()){
				System.out.println("commitInfoList is not empty....");
				for(CommitInfo commitInfo : commitInfoList){
					commitCode_ = commitInfo.getCode();
					if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
					this.commitMap.put(commitCode_, commitInfo);
					if(commitCode.equals(commitCode_)){
						String objCode = commitInfo.getObjectCode();
						if(resMap.containsKey(objCode))resMap.get(objCode).add(commitInfo);
						else{
							List<CommitInfo> val = new ArrayList<CommitInfo>();
							val.add(commitInfo);
							resMap.put(objCode, val);
						}
					}
				}
			}else if(res!=null){
				System.out.println("commitInfo is not empty....");
				String objCode = res.getObjectCode();
				if(resMap.containsKey(objCode))resMap.get(objCode).add(res);
				else{
					List<CommitInfo> val = new ArrayList<CommitInfo>();
					val.add(res);
					resMap.put(objCode, val);
				}
			} 
		}
		
		
		if(resMap.isEmpty())return resMap;
		//organize by date
		SimpleDateFormat format = new SimpleDateFormat("YYYY-MM-DD hh:mm:ss.SSS");
		for(String objCode : resMap.keySet()){
		List<CommitInfo> commitInfoListTmp = resMap.get(objCode);
		if(!commitInfoListTmp.isEmpty()){
		int cnt = commitInfoListTmp.size();
		System.out.println("cnt : "+cnt);
		int cnt2;
		for(int i=0;i<cnt;i++){
			cnt2 = cnt-i-1;
			for(int k=0;k<cnt2;k++){
				System.out.println("k : "+k+" cnt2 : "+cnt2);
				CommitInfo latestInfo = commitInfoListTmp.get(k);
				Date latestDate = format.parse(latestInfo.getDate());
				GregorianCalendar latestCalendar = new GregorianCalendar();
				latestCalendar.setTime(latestDate);
				
				CommitInfo info = commitInfoListTmp.get(k+1);
				Date date = format.parse(info.getDate());
				GregorianCalendar calendar = new GregorianCalendar();
				calendar.setTime(date);
				if(latestCalendar.before(calendar)){
					System.out.println("exchange  : "+k+"  and  "+k+1);
					commitInfoListTmp.remove(k);
					commitInfoListTmp.remove(k+1);
					System.out.println("list ise : "+commitInfoListTmp.size());
					commitInfoListTmp.add(k, info);
					commitInfoListTmp.add(k+1, latestInfo);
				}
			}
		}
		}
		}
	
		
		return resMap;
	}
	
	public CommitInfo searchCommitCode(String commitCode) throws FileNotFoundException, DAOException, FileException, SftpException, IOException, JSchException, RemoteFileException, ParseException, FolderException, MemberException, ProjectException, TeamException{
		
		CommitInfo res = null;
		if(!this.commitMap.containsKey(commitCode)){

			List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
			String commitCode_=new String();
			if(!commitInfoList.isEmpty()){
				for(CommitInfo commitInfo : commitInfoList){
					commitCode_ = commitInfo.getCode();
					if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
					this.commitMap.put(commitCode_, commitInfo);
					if(commitCode.equals(commitCode_))res=commitInfo;
				}
			} 
		}else{
			res = this.commitMap.get(commitCode);
			if(res.getOriginFileDescriptioin()==null){
				List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
				String commitCode_=new String();
				if(!commitInfoList.isEmpty()){
					for(CommitInfo commitInfo : commitInfoList){
						commitCode_ = commitInfo.getCode();
						if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
						this.commitMap.put(commitCode_, commitInfo);
						if(commitCode.equals(commitCode_))res=commitInfo;
					}
				}
			}
		}
		
		return res;
	}

	public String searchCommitDescription(String commitCode) throws FileNotFoundException, DAOException, FileException, SftpException, IOException, JSchException, RemoteFileException, ParseException, FolderException, MemberException, ProjectException, TeamException{
		
		System.out.println("\n      CommitInfoManager : searchCommitDescription start!  line  416 @");
		CommitInfo res = null;
		if(!this.commitMap.containsKey(commitCode)){
			System.out.println("no commitCode.......");
			List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
			String commitCode_=new String();
			if(!commitInfoList.isEmpty()){
				for(CommitInfo commitInfo : commitInfoList){
					commitCode_ = commitInfo.getCode();
					if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
					this.commitMap.put(commitCode_, commitInfo);
					if(commitCode.equals(commitCode_))res=commitInfo;
				}
			} 
		}
		else if(this.commitMap.get(commitCode).getDescription()==null){
			System.out.println("yes commitCode....... but no commitContent.....");
			List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
			String commitCode_=new String();
			if(!commitInfoList.isEmpty()){
				for(CommitInfo commitInfo : commitInfoList){
					commitCode_ = commitInfo.getCode();
					if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
					this.commitMap.put(commitCode_, commitInfo);
					if(commitCode.equals(commitCode_))res=commitInfo;
				}
			}
		}else res = this.commitMap.get(commitCode);
		return res.getDescription();
	}

	public String searchCommitDescription(List<String> commitCodeList) throws FileNotFoundException, DAOException, FileException, SftpException, IOException, JSchException, RemoteFileException, ParseException, FolderException, MemberException, ProjectException, TeamException{
		
		System.out.println("\n      CommitInfoManager : searchCommitDescription start!  line  446 @");
		CommitInfo res = null;
		for(String commitCode : commitCodeList){
			if(!this.commitMap.containsKey(commitCode)){
				System.out.println("no commitCode.......");
				List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
				String commitCode_=new String();
				if(!commitInfoList.isEmpty()){
					for(CommitInfo commitInfo : commitInfoList){
						commitCode_ = commitInfo.getCode();
						if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
						this.commitMap.put(commitCode_, commitInfo);
						if(commitCode.equals(commitCode_))res=commitInfo;
					}
				} 
			}
			else if(this.commitMap.get(commitCode).getDescription()==null){
				System.out.println("yes commitCode....... but no commitContent.....");
				List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
				String commitCode_=new String();
				if(!commitInfoList.isEmpty()){
					for(CommitInfo commitInfo : commitInfoList){
						commitCode_ = commitInfo.getCode();
						if(this.commitMap.containsKey(commitCode_)) this.commitMap.remove(commitCode_);
						this.commitMap.put(commitCode_, commitInfo);
						if(commitCode.equals(commitCode_))res=commitInfo;
					}
				}
			}else res = this.commitMap.get(commitCode);
		}
		
		return res.getDescription();
	}

	public String searchCommitOriginFileContent(String commitCode) throws FileNotFoundException, DAOException, FileException, SftpException, IOException, JSchException, RemoteFileException, ParseException, FolderException, MemberException, ProjectException, TeamException{
		
		System.out.println("\n      CommitInfoManager : searchCommitDescription start!  line  416 @");
		String resRes = null;
		CommitInfo info;
		if(!this.commitMap.containsKey(commitCode)){
			info = CommitInfoDBManager.getINSTANCE().searchOnlyCommitCode(commitCode);
		}else {
			info = this.commitMap.get(commitCode);
		}
		
		String objCode = info.getObjectCode();
		String date = info.getDate();
		List<CommitInfo> tmpList = CommitInfoDBManager.getINSTANCE().searchCommitInfoByDate(objCode, date);
		if(!tmpList.isEmpty()){
			CommitInfo res;
			if(tmpList.size()>=2){
				res = tmpList.get(tmpList.size()-2); 
			}else return null;
			if(this.commitMap.containsKey(res.getCode())){
				CommitInfo res2 = this.commitMap.get(res.getCode());
				if(res2.getOriginFileDescriptioin()!=null){
					resRes = res2.getOriginFileDescriptioin();
					return resRes;
				}
			}

			List<CommitInfo> commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitCode(commitCode);
			if(!commitInfoList.isEmpty()){
				for(CommitInfo cm : commitInfoList){
					if(res.getCode().equals(cm.getCode()))resRes = cm.getOriginFileDescriptioin();
					if(this.commitMap.containsKey(cm.getCode()))this.commitMap.remove(cm.getCode());
					this.commitMap.put(cm.getCode(), cm);
				}
			}
		}
		return resRes;
	}
	
	public void searchMemberCommit(String memberCode) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		
		//member project
		Map<String,Map<String,List<CommitInfo>>> resMap = CommitInfoDBManager.getINSTANCE().searchMemberCommit(memberCode);
		for(String first : resMap.keySet()){
			
			if(new StringTokenizer(first, "_").nextToken().equals("member")){
				
				Map<String,List<CommitInfo>> tmpMap = resMap.get(first);
				for(String projectCode : tmpMap.keySet()){
					List<CommitInfo> infoList = tmpMap.get(projectCode);
					if(!infoList.isEmpty()){this.insertModel(infoList,memberCode);}
				}
			}else{
				Map<String,List<CommitInfo>> tmpMap = resMap.get(first);
				for(String projectCode : tmpMap.keySet()){
					List<CommitInfo> infoList = tmpMap.get(projectCode);
					if(!infoList.isEmpty()){this.insertModel(first,infoList);}
				}
			}
		}
	}
	
	public Map<String,List<CommitForm>> searchMemberProjectCommit(String memberCode,String projectCode) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException{
		
		System.out.println("searchMemberProjectCommit");
		
		Map<String,List<CommitForm>> resMap = new HashMap<String,List<CommitForm>>();
		
		//member project
		//if(!this.memberCommitMap.containsKey(memberCode)){this.searchMemberCommit(memberCode);}
		if(!this.memberCommitMap.containsKey(memberCode)){
			System.out.println("\n여기는 진짜 한번이면 되는데...........\n");
			List<CommitInfo> commitList = CommitInfoDBManager.getINSTANCE().searchMemberProjectCommit(memberCode,projectCode);
			if(!commitList.isEmpty())this.insertModel(commitList,memberCode);
			else System.out.println("res is null");
		}


		System.out.println("alreay : "+this.memberCommitMap.keySet().iterator().next());
		/*for(String c : this.memberCommitMap.get(memberCode).get(this.memberCommitMap.get(memberCode).keySet().iterator().next()).getNotMergeCodeMap()){
			System.out.println("not merged : ...........   "+c+"\n\n_");
		}*/
		if(this.memberCommitMap.containsKey(memberCode)){
			System.out.println("\n\nmake ressult");
			CommitCodeList codeList = this.memberCommitMap.get(memberCode).get(projectCode);
			if(codeList!=null){
				List<CommitForm> readList = new ArrayList<CommitForm>();
				List<CommitForm> unreadList = new ArrayList<CommitForm>();
				//System.out.println("size : "+codeList.getMergeCodeList().size()+"  :  "+codeList.getNotMergeCodeList().size());
				for(String objCode : codeList.getMergeCodeMap().keySet()){
				List<String> tmpCodeList = codeList.getMergeCodeMap().get(objCode);
				if(!tmpCodeList.isEmpty()){
					for(String code : tmpCodeList){
						System.out.println(code);
						CommitInfo commitInfo = this.commitMap.get(code);
						String commiterNickName = MemberManager.getINSTANCE().searchMemberCode(commitInfo.getMemberCode()).getNickName();
						if(commitInfo==null)System.out.println("res is null ");
						
						readList.add(new CommitForm(code, commitInfo.getTitle(), commitInfo.getDate(),commitInfo.getMemberCode(),commiterNickName,commitInfo.getContent()));
						
					}
				}
				}
				for(String objCode : codeList.getNotMergeCodeMap().keySet()){
				List<String> tmpCodeList = codeList.getNotMergeCodeMap().get(objCode);
				if(!tmpCodeList.isEmpty()){
					for(String code : tmpCodeList){
						System.out.println(code);
						CommitInfo commitInfo = this.commitMap.get(code);
						String commiterNickName = MemberManager.getINSTANCE().searchMemberCode(commitInfo.getMemberCode()).getNickName();
						unreadList.add(new CommitForm(code, commitInfo.getTitle(), commitInfo.getDate(),commitInfo.getMemberCode(),commiterNickName,commitInfo.getContent()));
					}
				}
				}
				if(readList.isEmpty())System.out.println("readList is empty.......");
				resMap.put("merge", readList);
				resMap.put("notmerge", unreadList);
			}
			return resMap;
		}
		return resMap;
	}

	public Map<String,List<CommitForm>> searchTeamProjectCommit(String teamCode,String brachCode,String projectCode) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		
		Map<String,List<CommitForm>> resMap = new HashMap<String,List<CommitForm>>();
		//member project
		if(!this.teamCommitMap.containsKey(teamCode)){
			loadTeamProjectCommit(teamCode, brachCode, projectCode);
			if(!this.teamCommitMap.containsKey(teamCode))return resMap;
		}
		if(!this.teamCommitMap.get(teamCode).containsKey(brachCode)){
			loadTeamProjectCommit(teamCode, brachCode, projectCode);
			if(!this.teamCommitMap.get(teamCode).containsKey(brachCode))return resMap;
		}
		if(!this.teamCommitMap.get(teamCode).get(brachCode).containsKey(projectCode)){
			loadTeamProjectCommit(teamCode, brachCode, projectCode);
			if(!this.teamCommitMap.get(teamCode).get(brachCode).containsKey(projectCode))return resMap;
		}
		
		CommitCodeList codeList = this.teamCommitMap.get(teamCode).get(brachCode).get(projectCode);
		if(codeList!=null){
			List<CommitForm> readList = new ArrayList<CommitForm>();
			List<CommitForm> unreadList = new ArrayList<CommitForm>();
			for(String objCode : codeList.getMergeCodeMap().keySet()){
			List<String> tmpCodeList = codeList.getMergeCodeMap().get(objCode);
			if(!tmpCodeList.isEmpty()){
				for(String code : tmpCodeList){
					System.out.println(code);
					CommitInfo commitInfo = this.commitMap.get(code);
					String commiterNickName = MemberManager.getINSTANCE().searchMemberCode(commitInfo.getMemberCode()).getNickName();
					if(commitInfo==null)System.out.println("res is null ");
					
					readList.add(new CommitForm(code, commitInfo.getTitle(), commitInfo.getDate(),commitInfo.getMemberCode(),commiterNickName,commitInfo.getContent()));
					
				}
			}
			}
			for(String objCode : codeList.getNotMergeCodeMap().keySet()){
			List<String> tmpCodeList = codeList.getNotMergeCodeMap().get(objCode);
			if(!tmpCodeList.isEmpty()){
				for(String code : tmpCodeList){
					System.out.println(code);
					CommitInfo commitInfo = this.commitMap.get(code);
					String commiterNickName = MemberManager.getINSTANCE().searchMemberCode(commitInfo.getMemberCode()).getNickName();
					unreadList.add(new CommitForm(code, commitInfo.getTitle(), commitInfo.getDate(),commitInfo.getMemberCode(),commiterNickName,commitInfo.getContent()));
				}
			}
			}
			resMap.put("merge", readList);
			resMap.put("notmerge", unreadList);
		}
		return resMap;
	}
	
	public CommitInfo searchMemberProLatestFolderCommit(String memberCode,String projectCode,String folderCode) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException{
		
		System.out.println("searchMemberProjectCommit");
		
		Map<String,List<CommitForm>> resMap = new HashMap<String,List<CommitForm>>();
		
		//member project
		//if(!this.memberCommitMap.containsKey(memberCode)){this.searchMemberCommit(memberCode);}
		if(!this.memberCommitMap.containsKey(memberCode)){
			System.out.println("\n여기는 진짜 한번이면 되는데...........\n");
			List<CommitInfo> commitList = CommitInfoDBManager.getINSTANCE().searchMemberProjectCommit(memberCode,projectCode);
			if(!commitList.isEmpty())this.insertModel(commitList,memberCode);
			else System.out.println("res is null");
		}

		System.out.println("alreay : "+this.memberCommitMap.keySet().iterator().next());
		/*for(String c : this.memberCommitMap.get(memberCode).get(this.memberCommitMap.get(memberCode).keySet().iterator().next()).getNotMergeCodeList()){
			System.out.println("not merged : ...........   "+c+"\n\n\n\n\n_");
		}*/
		if(this.memberCommitMap.containsKey(memberCode)){
			System.out.println("\n\nmake ressult");
			CommitCodeList codeList = this.memberCommitMap.get(memberCode).get(projectCode);
			if(codeList!=null){
				String latestCode = codeList.getLatestCodePerFolder(folderCode);
				if(latestCode!=null){
					return this.commitMap.get(latestCode);
				}
			}
		}
		return null;
	}
	public CommitInfo searchTeamProLatestCommit(String memberCode,String teamCode,String projectCode,String folderCode) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		
		Map<String,List<CommitForm>> resMap = new HashMap<String,List<CommitForm>>();
		//member project
		if(!this.teamCommitMap.containsKey(teamCode)){this.searchTeamProjectCommit(memberCode, teamCode, projectCode);}
		if(!this.teamCommitMap.get(teamCode).containsKey(memberCode)){
			List<CommitInfo> commitList = CommitInfoDBManager.getINSTANCE().searchTeamProjectCommit(memberCode,teamCode,projectCode);
			if(!commitList.isEmpty()){
				this.insertModel(teamCode, commitList);
			}else return null;
		}
		if(!this.teamCommitMap.get(teamCode).get(memberCode).containsKey(projectCode)){
			List<CommitInfo> commitList = CommitInfoDBManager.getINSTANCE().searchTeamProjectCommit(memberCode,teamCode,projectCode);
			if(!commitList.isEmpty()){
				this.insertModel(teamCode, commitList);
			}
		}
		
		CommitCodeList codeList = this.teamCommitMap.get(teamCode).get(memberCode).get(projectCode);
		if(codeList!=null){
			String latestCode = codeList.getLatestCodePerFolder(folderCode);
			if(latestCode!=null){
				return this.commitMap.get(latestCode);
			}
		}
		return null;
	}
	
	public List<CommitInfo> searchCommitInfoContentDetails(String fileCode, List<CommitInfo> commitInfoList) throws FileNotFoundException, ParseException, DAOException, FileException, SftpException, IOException, JSchException, RemoteFileException{

		int start = commitInfoList.size();
		commitInfoList = CommitInfoDBManager.getINSTANCE().searchCommitInfoContentDetails(fileCode, commitInfoList);
		if(!commitInfoList.isEmpty()){
			for(CommitInfo commit : commitInfoList){
				String commitCode = commit.getCode();
				if(this.commitMap.containsKey(commitCode))this.commitMap.remove(commitCode);
				this.commitMap.put(commitCode, commit);
			}
			int leng = commitInfoList.size();
			return commitInfoList.subList(leng-start, leng);
		}
		
		return commitInfoList;
	}
	
////////////////////                  modify                   ////////////////////////////////////////
	
	public boolean mergeSharedProCommitInfo(String memberCode,String proCode,String commitCode) throws DAOException, ParseException, FolderException, IOException, FileException, ProjectException, TeamException, SftpException, JSchException, RemoteFileException, MemberException{
		
		System.out.println("CommitInfoManager  :::  mergeSHaredProCommitInfo  "+memberCode+" // "+proCode+" // "+commitCode);
		if(CommitInfoDBManager.getINSTANCE().mergeCommitCode(commitCode)){
			if(!this.memberCommitMap.containsKey(memberCode)){
				this.loadMemberProjectCommit(memberCode, proCode);
				if(this.memberCommitMap.containsKey(memberCode)){
					if(this.memberCommitMap.get(memberCode).containsKey(proCode)){
						String objCode = this.commitMap.get(commitCode).getObjectCode();
						this.memberCommitMap.get(memberCode).get(proCode).mergeCode(commitCode,objCode);
						return true;
					}
				}
			}
		}else System.out.println("change db commitInfo FAILLLLLL......tt");
		return false;
	}
	
	public Map<String,List<String>> sendMergeCommitList(String memberCode, String projectCode) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		
		if(!this.memberCommitMap.containsKey(memberCode))this.searchMemberCommit(memberCode);
		if(!this.memberCommitMap.get(memberCode).containsKey(projectCode))this.searchMemberProjectCommit(memberCode, projectCode);
		
		Map<String, List<String>> notMergeCodeMap = this.memberCommitMap.get(memberCode).get(projectCode).getNotMergeCodeMap();
		if(notMergeCodeMap.isEmpty())return notMergeCodeMap;
		
		List<String> notMergeCodeList = new ArrayList<String>();
		for(String objCode : notMergeCodeMap.keySet()){
			List<String> val = notMergeCodeMap.get(objCode);
			if(!val.isEmpty())notMergeCodeList.addAll(notMergeCodeList);
		}
		if(notMergeCodeList.isEmpty())return new HashMap<String, List<String>>();

		if(CommitInfoDBManager.getINSTANCE().sendMergeCommitList(notMergeCodeList)){
			this.memberCommitMap.get(memberCode).get(projectCode).mergeCodeMap(notMergeCodeMap);
			return notMergeCodeMap;
		}
		return new HashMap<String, List<String>>();
	}
	
	public Map<String,List<String>> sendMergeCommitList(String memberCode, String projectCode,Map<String,List<String>> notMergeCodeMap) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		
		if(!this.memberCommitMap.containsKey(memberCode))this.searchMemberCommit(memberCode);
		if(!this.memberCommitMap.get(memberCode).containsKey(projectCode))this.searchMemberProjectCommit(memberCode, projectCode);
		
		Map<String,List<String>> resMap = new HashMap<String, List<String>>();
		if(notMergeCodeMap.isEmpty()) return resMap;
		
		List<String> notMergeCodeList = new ArrayList<String>();
		for(String objCode : notMergeCodeMap.keySet()){
			List<String> val = notMergeCodeMap.get(objCode);
			if(!val.isEmpty())notMergeCodeList.addAll(notMergeCodeList);
		}
		if(notMergeCodeList.isEmpty())return new HashMap<String, List<String>>();

		if(CommitInfoDBManager.getINSTANCE().sendMergeCommitList(notMergeCodeList)){
			this.memberCommitMap.get(memberCode).get(projectCode).mergeCodeMap(notMergeCodeMap);
			return notMergeCodeMap;
		}
		return new HashMap<String, List<String>>();
	}

	public Map<String,List<String>> sendMergeTeamCommitList(String teamCode, String memberCode,String proCode) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		
		//team send to teamMember
		if(!this.teamCommitMap.containsKey(teamCode))this.loadTeamProjectCommit(teamCode, memberCode, proCode);
		if(this.teamCommitMap.get(teamCode).containsKey(memberCode)){
			Map<String, List<String>> notMergeCodeMap = this.memberCommitMap.get(memberCode).get(proCode).getNotMergeCodeMap();
			List<String> notMergeCodeList = new ArrayList<String>();
			for(String objCode : notMergeCodeMap.keySet()){
				List<String> val = notMergeCodeMap.get(objCode);
				if(!val.isEmpty())notMergeCodeList.addAll(notMergeCodeList);
			}
			if(notMergeCodeList.isEmpty())return new HashMap<String, List<String>>();
			if(CommitInfoDBManager.getINSTANCE().sendMergeCommitList(notMergeCodeList)){
				this.teamCommitMap.get(teamCode).get(memberCode).get(proCode).mergeCodeMap(notMergeCodeMap);
				return notMergeCodeMap;
			}
		}
		return new HashMap<String, List<String>>();
	}
	public Map<String,List<String>> sendMergeTeamCommitList(String teamCode, String memberCode,String proCode,Map<String,List<String>> notMergeCodeMap) throws DAOException, ParseException, FolderException, ProjectException, IOException, TeamException, FileException, SftpException, JSchException, RemoteFileException, MemberException, CommitExcetion{
		
		//team send to teamMember merge check!! in db
		if(!this.teamCommitMap.containsKey(teamCode))this.loadTeamProjectCommit(teamCode, memberCode, proCode);
		if(this.teamCommitMap.get(teamCode).containsKey(memberCode)){
			if(notMergeCodeMap.isEmpty()) return notMergeCodeMap;
			
			List<String> notMergeCodeList = new ArrayList<String>();
			for(String objCode : notMergeCodeMap.keySet()){
				List<String> val = notMergeCodeMap.get(objCode);
				if(!val.isEmpty())notMergeCodeList.addAll(notMergeCodeList);
			}
			if(CommitInfoDBManager.getINSTANCE().sendMergeCommitList(notMergeCodeList)){
				this.teamCommitMap.get(teamCode).get(memberCode).get(proCode).mergeCodeMap(notMergeCodeMap);
				return notMergeCodeMap;
			}
		}
		return new HashMap<String, List<String>>();
	}
	

////////////////////                  delete                   ////////////////////////////////////////	
	
	
/////////////////////////////////////////////////////////////////////////////////	
	
	
	private void insertModel(CommitInfo commitInfo) throws DAOException, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, ProjectException, MemberException, FileException, RemoteFileException, TeamException{
		
		System.out.println("CommitInfoManager  ::::          insertModel(CommitInfo commitInfo)              383");
		if(!this.commitMap.containsKey(commitInfo.getCode()))this.commitMap.put(commitInfo.getCode(), commitInfo);
		
		String objCode = commitInfo.getObjectCode();
		String projectPath = new String();
		String kind = new StringTokenIterator(objCode, "_").first();
		System.out.println("shat ??????     "+objCode+"      ---------------    "+kind);
		
		if(kind.equals("folder")){
			OriginFolder oriFolder = (OriginFolder) FolderManager.getINSTANCE().searchFolderByFolderCode(objCode);
			
			//make projectPath
			StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
			projectPath= tokens.nextToken();
			for(int i=0;i<3;i++){
				projectPath+="\\"+tokens.nextToken();
			}
			
		}else if(kind.equals("file")){
			OriginFile oriFile = (OriginFile) FileManager.getINSTANCE().searchFileCode(objCode);
			
			System.out.println(":::::   "+oriFile.getPath());
			//make projectPath
			StringTokenizer tokens = new StringTokenizer(oriFile.getPath(), "\\");
			projectPath= tokens.nextToken();
			for(int i=0;i<3;i++){
				projectPath+="\\"+tokens.nextToken();
			}
		}

		OriginProject oriPro = (OriginProject) ProjectManager.getINSTANCE().searchProjectByProjectPath(projectPath);
		String projectCode = oriPro.getCode();
		System.out.println("------------------------  "+projectPath+"   "+projectCode);
		String memberCode = oriPro.getOwner();
		String commitCode = commitInfo.getCode();
		
		
		boolean read = commitInfo.isMerge();
		if(!this.memberCommitMap.containsKey(memberCode)){
			CommitCodeList co = new CommitCodeList();
			if(read){co.addMergeCode(commitCode,objCode);}
			else{co.addNotMergeCode(commitCode,objCode);}
			Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
			val.put(projectCode, co);
			this.memberCommitMap.put(memberCode,val);
		}else{
			if(this.memberCommitMap.get(memberCode).containsKey(projectCode)){
				if(read){this.memberCommitMap.get(memberCode).get(projectCode).addMergeCode(commitCode,objCode);}
				else this.memberCommitMap.get(memberCode).get(projectCode).addNotMergeCode(commitCode,objCode);
			}else{
				CommitCodeList co = new CommitCodeList();
				if(read){co.addMergeCode(commitCode,objCode);}
				else{co.addNotMergeCode(commitCode,objCode);}
				this.memberCommitMap.get(memberCode).put(projectCode, co);
			}
		}

	}

	private void insertModel(List<CommitInfo> commitInfoList,String memberCode) throws DAOException, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, MemberException, ProjectException, TeamException, FileException, RemoteFileException{
		System.out.println("\n      CommitInfoManager start !!! : insertModel(List<CommitInfo> commitInfoList)   >>>>>> line   815");
		for(CommitInfo commitInfo : commitInfoList){
			
			String commitCode = commitInfo.getCode();
			if(!this.commitMap.containsKey(commitCode))this.commitMap.put(commitCode, commitInfo);
			String objCode = commitInfo.getObjectCode();
			
			String projectPath = new String();
			String memNickName = MemberManager.getINSTANCE().searchMemberCode(commitInfo.getMemberCode()).getNickName();
			System.out.println("memberNickName : "+memNickName);
			String token = new StringTokenIterator(commitInfo.getObjectCode(), "_").first();
			System.out.println("token : "+token);
			//System.out.println("TOKEN    ::   "+token+"    code    ::   "+commitInfo.getObjectCode());
			
			//get folder or file's project path start
			if(token.equals("folder")){
				OriginFolder oriFolder = (OriginFolder) FolderManager.getINSTANCE().searchFolderByFolderCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					projectPath+="\\"+tmp;
					if(tmp.equals(memNickName)){
						projectPath+="\\"+tokens.nextToken();
						System.out.println("This is projectPath   :  "+projectPath);
						break;
					}
				}
				
			}else if(token.equals("file")){
				OriginFile oriFolder = (OriginFile) FileManager.getINSTANCE().searchFileCode(commitInfo.getObjectCode());
				
				//make projectPath
				System.out.println("make ...what..... "+oriFolder.getPath());
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					projectPath+="\\"+tmp;
					if(tmp.equals(memNickName)){
						projectPath+="\\"+tokens.nextToken();
						System.out.println("This is projectPath   :  "+projectPath);
						break;
					}
				}
			}else {
				OriginProject oirPro = (OriginProject) ProjectManager.getINSTANCE().searchProjectByProjectPath(commitInfo.getObjectCode());
				projectPath = oirPro.getPath();
			}
			//get folder or file's project path end

			System.out.println("ori  "+projectPath);
			String projectCode = ((OriginProject)ProjectManager.getINSTANCE().searchProjectByProjectPath(projectPath)).getCode();

			System.out.println("ori  "+projectCode);
			
			boolean read = commitInfo.isMerge();
			if(!this.memberCommitMap.containsKey(memberCode)){
				CommitCodeList co = new CommitCodeList();
				if(read){co.addMergeCode(commitCode,objCode);}
				else{co.addNotMergeCode(commitCode,objCode);}
				Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
				val.put(projectCode, co);
				this.memberCommitMap.put(memberCode,val);
			}else{
				if(this.memberCommitMap.get(memberCode).containsKey(projectCode)){
					if(read){this.memberCommitMap.get(memberCode).get(projectCode).addMergeCode(commitCode,objCode);}
					else this.memberCommitMap.get(memberCode).get(projectCode).addNotMergeCode(commitCode,objCode);
				}else{
					CommitCodeList co = new CommitCodeList();
					if(read){co.addMergeCode(commitCode,objCode);}
					else{co.addNotMergeCode(commitCode,objCode);}
					this.memberCommitMap.get(memberCode).put(projectCode, co);
				}
			}

		}
		System.out.println(this.commitMap.size());
		System.out.println("end !!! : insertModel(List<CommitInfo> commitInfoList, String memberCode)   >>>>>> ");
	}

	private void insertModel(List<CommitInfo> commitInfoList,String teamCode,String memberCode) throws DAOException, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, MemberException, ProjectException, TeamException, FileException, RemoteFileException{
		System.out.println("\nstart !!! : insertModel(List<CommitInfo> commitInfoList,String teamCode,String memberCode)   >>>>>> ");
		for(CommitInfo commitInfo : commitInfoList){
			if(!this.commitMap.containsKey(commitInfo.getCode()))this.commitMap.put(commitInfo.getCode(), commitInfo);
			
			String projectPath = new String();
			String memNickName = MemberManager.getINSTANCE().searchMemberCode(commitInfo.getMemberCode()).getNickName();
			String token = new StringTokenIterator(commitInfo.getObjectCode(), "_").first();
			//System.out.println("TOKEN    ::   "+token+"    code    ::   "+commitInfo.getObjectCode());
			
			//get folder or file's project path start
			if(token.equals("folder")){
				OriginFolder oriFolder = (OriginFolder) FolderManager.getINSTANCE().searchFolderByFolderCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(memNickName)){projectPath+="\\"+tmp;break;}
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
				
			}else if(token.equals("file")){
				OriginFile oriFolder = (OriginFile) FileManager.getINSTANCE().searchFileCode(commitInfo.getObjectCode());
				
				//make projectPath
				System.out.println("make ...what..... "+oriFolder.getPath());
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(memNickName)){projectPath+="\\"+tmp;break;}
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
			}else {
				OriginProject oirPro = (OriginProject) ProjectManager.getINSTANCE().searchProjectByProjectPath(commitInfo.getObjectCode());
				projectPath = oirPro.getPath();
			}
			//get folder or file's project path end

			System.out.println("ori  "+projectPath);
			String projectCode = ((OriginProject)ProjectManager.getINSTANCE().searchProjectByProjectPath(projectPath)).getCode();

			System.out.println("ori  "+projectCode);
			
			boolean read = commitInfo.isMerge();
			if(!this.teamCommitMap.containsKey(teamCode)){
				CommitCodeList co = new CommitCodeList();
				
				if(read){co.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
				else{co.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
				
				Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
				val.put(projectCode, co);
				Map<String,Map<String,CommitCodeList>> val2 = new HashMap<String, Map<String,CommitCodeList>>();
				val2.put(memberCode, val);
				this.teamCommitMap.put(teamCode,val2);
			}else{
				if(this.teamCommitMap.get(teamCode).containsKey(memberCode)){
					if(this.teamCommitMap.get(teamCode).get(memberCode).containsKey(projectCode)){
						if(read){this.teamCommitMap.get(teamCode).get(memberCode).get(projectCode).addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
						else this.teamCommitMap.get(teamCode).get(memberCode).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
					}else{
						CommitCodeList co = new CommitCodeList();
						if(read){co.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
						else{co.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
						this.teamCommitMap.get(teamCode).get(memberCode).put(projectCode, co);
					}
				}else{
					CommitCodeList co = new CommitCodeList();
					
					if(read){co.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
					else{co.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
					
					Map<String,CommitCodeList> val = new HashMap<String, CommitCodeList>();
					val.put(projectCode, co);
					this.teamCommitMap.get(teamCode).put(memberCode, val);
				}

			}
		}
		System.out.println(this.commitMap.size());
		System.out.println("end !!! : insertModel(List<CommitInfo> commitInfoList, String memberCode)   >>>>>> ");
	}
	
	
	private void insertModel(Map<String,CommitInfo> commitInfoMap) throws DAOException, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, FileException, RemoteFileException, MemberException, ProjectException, TeamException{
		for(CommitInfo commitInfo : commitInfoMap.values()){
			if(!this.commitMap.containsKey(commitInfo.getCode()))this.commitMap.put(commitInfo.getCode(), commitInfo);
			
			String projectPath = new String();
			if(new StringTokenIterator(commitInfo.getObjectCode(), "_").next().equals("folder")){
				OriginFolder oriFolder = (OriginFolder) FolderManager.getINSTANCE().searchFolderByFolderCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(commitInfo.getMemberCode()))break;
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
				
			}else{
				OriginFile oriFolder = (OriginFile) FileManager.getINSTANCE().searchFileCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(commitInfo.getMemberCode()))break;
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
			}

			String projectCode = ((OriginProject)ProjectManager.getINSTANCE().searchProjectByProjectPath(projectPath)).getCode();
			
			if(this.memberCommitMap.get(commitInfo.getMemberCode()).containsKey(projectCode)){
				this.memberCommitMap.get(commitInfo.getMemberCode()).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
			}else{
				CommitCodeList co = new CommitCodeList();
				co.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				this.memberCommitMap.get(commitInfo.getMemberCode()).put(projectCode, co);
			}

		}
	}
	

	private void insertModel(String teamCode,CommitInfo commitInfo) throws DAOException, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, FileException, RemoteFileException, MemberException, ProjectException, TeamException{
		
		if(!this.commitMap.containsKey(commitInfo.getCode()))this.commitMap.put(commitInfo.getCode(), commitInfo);
		
		String projectPath = new String();
		if(new StringTokenIterator(commitInfo.getObjectCode(), "_").next().equals("folder")){
			OriginFolder oriFolder = (OriginFolder) FolderManager.getINSTANCE().searchFolderByFolderCode(commitInfo.getObjectCode());
			
			//make projectPath
			StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
			projectPath= tokens.nextToken();
			String tmp;
			while(tokens.hasMoreElements()){
				tmp = tokens.nextToken();
				if(tmp.equals(commitInfo.getMemberCode()))break;
				projectPath+="\\"+tmp;
			}projectPath+="\\"+tokens.nextToken();
			
		}else{
			OriginFile oriFolder = (OriginFile) FileManager.getINSTANCE().searchFileCode(commitInfo.getObjectCode());
			
			//make projectPath
			StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
			projectPath= tokens.nextToken();
			String tmp;
			while(tokens.hasMoreElements()){
				tmp = tokens.nextToken();
				if(tmp.equals(commitInfo.getMemberCode()))break;
				projectPath+="\\"+tmp;
			}projectPath+="\\"+tokens.nextToken();
		}

		String projectCode = ((OriginProject)ProjectManager.getINSTANCE().searchProjectByProjectPath(projectPath)).getCode();
		
		if(this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).containsKey(projectCode)){this.memberCommitMap.get(commitInfo.getMemberCode()).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
		else{
			CommitCodeList co = new CommitCodeList();
			co.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
			this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).put(projectCode, co);
		}

	}

	private void insertModel(String teamCode,List<CommitInfo> commitInfoList) throws DAOException, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, FileException, RemoteFileException, MemberException, ProjectException, TeamException{
		for(CommitInfo commitInfo : commitInfoList){
			if(!this.commitMap.containsKey(commitInfo.getCode()))this.commitMap.put(commitInfo.getCode(), commitInfo);
			
			String projectPath = new String();
			if(new StringTokenIterator(commitInfo.getObjectCode(), "_").next().equals("folder")){
				OriginFolder oriFolder = (OriginFolder) FolderManager.getINSTANCE().searchFolderByFolderCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(commitInfo.getMemberCode()))break;
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
				
			}else{
				OriginFile oriFolder = (OriginFile) FileManager.getINSTANCE().searchFileCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(commitInfo.getMemberCode()))break;
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
			}

			String projectCode = ((OriginProject)ProjectManager.getINSTANCE().searchProjectByProjectPath(projectPath)).getCode();

			boolean read = commitInfo.isMerge();
			if(this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).containsKey(projectCode)){
				if(read){this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).get(projectCode).addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
				else this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
			}else{
				CommitCodeList co = new CommitCodeList();
				if(read){co.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
				else{co.addMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
				this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).put(projectCode, co);
			}
			
		}
	}

	private void insertModel(String teamCode,Map<String,CommitInfo> commitInfoMap) throws DAOException, ParseException, FolderException, FileNotFoundException, SftpException, IOException, JSchException, FileException, RemoteFileException, MemberException, ProjectException, TeamException{
		for(CommitInfo commitInfo : commitInfoMap.values()){
			if(!this.commitMap.containsKey(commitInfo.getCode()))this.commitMap.put(commitInfo.getCode(), commitInfo);
			
			String projectPath = new String();
			if(new StringTokenIterator(commitInfo.getObjectCode(), "_").next().equals("folder")){
				OriginFolder oriFolder = (OriginFolder) FolderManager.getINSTANCE().searchFolderByFolderCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(commitInfo.getMemberCode()))break;
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
				
			}else{
				OriginFile oriFolder = (OriginFile) FileManager.getINSTANCE().searchFileCode(commitInfo.getObjectCode());
				
				//make projectPath
				StringTokenizer tokens = new StringTokenizer(oriFolder.getPath(), "\\");
				projectPath= tokens.nextToken();
				String tmp;
				while(tokens.hasMoreElements()){
					tmp = tokens.nextToken();
					if(tmp.equals(commitInfo.getMemberCode()))break;
					projectPath+="\\"+tmp;
				}projectPath+="\\"+tokens.nextToken();
			}

			String projectCode = ((OriginProject)ProjectManager.getINSTANCE().searchProjectByProjectPath(projectPath)).getCode();
			
			if(this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).containsKey(projectCode)){this.memberCommitMap.get(commitInfo.getMemberCode()).get(projectCode).addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());}
			else{
				CommitCodeList co = new CommitCodeList();
				co.addNotMergeCode(commitInfo.getCode(),commitInfo.getObjectCode());
				this.teamCommitMap.get(teamCode).get(commitInfo.getMemberCode()).put(projectCode, co);
			}

		}
	}
}
